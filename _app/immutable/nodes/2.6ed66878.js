import{s as ge,n as Z,f as x,i as Q,r as Ce}from"../chunks/scheduler.c17f58d9.js";import{S as _e,i as be,g as T,s as P,h as w,j as y,c as X,y as ee,f as b,k as M,a as F,x as h,z as $,A as W,m as U,n as q,B as J,C as ne,D as re,E as Te,r as se,F as Me,u as le,l as Ee,v as ae,o as G,d as oe,t as ie,w as ue}from"../chunks/index.19f50f9c.js";function Y(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}const Ae=!0,Ve=Object.freeze(Object.defineProperty({__proto__:null,prerender:Ae},Symbol.toStringTag,{value:"Module"}));class V{constructor(t,n,r){this.departure=t,this.arrival=n,this.transfers=r}getDeparture(){return V.parseTime(this.departure)}getArrival(){return V.parseTime(this.arrival)}overtakes(t){return this.getDeparture()>t.getDeparture()&&this.getArrival()<t.getArrival()}getCriteria3(){return[-this.getDeparture(),this.getArrival(),this.transfers]}getCriteria2(){return[this.getArrival()-this.getDeparture(),this.transfers]}static formatTime(t){return`${Math.floor(t/60)}:${("0"+t%60).slice(-2)}`}static parseTime(t){const r=/^(\d{2}):(\d{2})$/g.exec(t);return r!=null?parseInt(r[1])*60+parseInt(r[2]):-1}}function ce(e,t,n){const r=e.slice();return r[11]=t[n],r[12]=t,r[13]=n,r}function fe(e,t,n){const r=e.slice();return r[14]=t[n],r[15]=t,r[16]=n,r}function he(e,t,n){const r=e.slice();return r[17]=t[n],r}function pe(e){let t,n,r=e[17]+"",a;return{c(){t=T("th"),n=T("div"),a=U(r),this.h()},l(i){t=w(i,"TH",{class:!0});var l=y(t);n=w(l,"DIV",{class:!0});var m=y(n);a=q(m,r),m.forEach(b),l.forEach(b),this.h()},h(){M(n,"class","font-semibold text-right"),M(t,"class","px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap")},m(i,l){F(i,t,l),h(t,n),h(n,a)},p:Z,d(i){i&&b(t)}}}function de(e){let t,n,r=e[14].departure+"",a,i,l,m=e[14].arrival+"",u,_,v,p,I,E,c,L="Remove",S,z;function B(){e[6].call(n,e[15],e[16])}function C(){e[7].call(l,e[15],e[16])}function O(){e[8].call(p,e[15],e[16])}function A(){return e[9](e[16])}return{c(){t=T("tr"),n=T("td"),a=U(r),i=P(),l=T("td"),u=U(m),_=P(),v=T("td"),p=T("input"),I=P(),E=T("td"),c=T("button"),c.textContent=L,this.h()},l(D){t=w(D,"TR",{});var f=y(t);n=w(f,"TD",{contenteditable:!0,class:!0});var o=y(n);a=q(o,r),o.forEach(b),i=X(f),l=w(f,"TD",{contenteditable:!0,class:!0});var R=y(l);u=q(R,m),R.forEach(b),_=X(f),v=w(f,"TD",{class:!0});var s=y(v);p=w(s,"INPUT",{type:!0,class:!0}),s.forEach(b),I=X(f),E=w(f,"TD",{class:!0});var k=y(E);c=w(k,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(c)!=="svelte-1bxtjqx"&&(c.textContent=L),k.forEach(b),f.forEach(b),this.h()},h(){M(n,"contenteditable","true"),M(n,"class","px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap decoration-pink-500"),e[14].departure===void 0&&x(B),J(n,"underline",V.parseTime(e[14].departure)===-1),M(l,"contenteditable","true"),M(l,"class","px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap decoration-pink-500"),e[14].arrival===void 0&&x(C),J(l,"underline",V.parseTime(e[14].arrival)===-1),M(p,"type","number"),M(p,"class","border-0 w-16"),M(v,"class","px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap"),M(c,"class","btn-sm border-slate-200 hover:border-slate-300 shadow-sm text-rose-500 mx-auto"),M(E,"class","px-5 first:pl-5 last:pr-5 py-3 whitespace-nowrap")},m(D,f){F(D,t,f),h(t,n),h(n,a),e[14].departure!==void 0&&(n.innerHTML=e[14].departure),h(t,i),h(t,l),h(l,u),e[14].arrival!==void 0&&(l.innerHTML=e[14].arrival),h(t,_),h(t,v),h(v,p),ne(p,e[14].transfers),h(t,I),h(t,E),h(E,c),S||(z=[$(n,"input",B),$(n,"keyup",function(){Q(e[1])&&e[1].apply(this,arguments)}),$(l,"input",C),$(l,"keyup",function(){Q(e[1])&&e[1].apply(this,arguments)}),$(p,"input",O),$(p,"change",function(){Q(e[1])&&e[1].apply(this,arguments)}),$(c,"click",A)],S=!0)},p(D,f){e=D,f&1&&r!==(r=e[14].departure+"")&&re(a,r),f&1&&e[14].departure!==n.innerHTML&&(n.innerHTML=e[14].departure),f&1&&J(n,"underline",V.parseTime(e[14].departure)===-1),f&1&&m!==(m=e[14].arrival+"")&&re(u,m),f&1&&e[14].arrival!==l.innerHTML&&(l.innerHTML=e[14].arrival),f&1&&J(l,"underline",V.parseTime(e[14].arrival)===-1),f&1&&Te(p.value)!==e[14].transfers&&ne(p,e[14].transfers)},d(D){D&&b(t),S=!1,Ce(z)}}}function me(e){let t,n,r;function a(){e[10].call(t,e[12],e[13])}return{c(){t=T("td"),this.h()},l(i){t=w(i,"TD",{class:!0,contenteditable:!0}),y(t).forEach(b),this.h()},h(){M(t,"class","px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap decoration-pink-500"),M(t,"contenteditable","true"),e[11]===void 0&&x(a)},m(i,l){F(i,t,l),e[11]!==void 0&&(t.innerHTML=e[11]),n||(r=$(t,"input",a),n=!0)},p(i,l){e=i,l&4&&e[11]!==t.innerHTML&&(t.innerHTML=e[11])},d(i){i&&b(t),n=!1,r()}}}function Le(e){let t,n,r,a,i,l,m='<div class="font-semibold text-right"></div>',u,_,v,p,I,E,c,L="Add",S,z,B=Y(e[3]),C=[];for(let o=0;o<B.length;o+=1)C[o]=pe(he(e,B,o));let O=Y(e[0]),A=[];for(let o=0;o<O.length;o+=1)A[o]=de(fe(e,O,o));let D=Y(e[2]),f=[];for(let o=0;o<D.length;o+=1)f[o]=me(ce(e,D,o));return{c(){t=T("div"),n=T("table"),r=T("thead"),a=T("tr");for(let o=0;o<C.length;o+=1)C[o].c();i=P(),l=T("th"),l.innerHTML=m,u=P(),_=T("tbody");for(let o=0;o<A.length;o+=1)A[o].c();v=P(),p=T("tr");for(let o=0;o<f.length;o+=1)f[o].c();I=P(),E=T("td"),c=T("button"),c.textContent=L,this.h()},l(o){t=w(o,"DIV",{class:!0});var R=y(t);n=w(R,"TABLE",{class:!0});var s=y(n);r=w(s,"THEAD",{class:!0});var k=y(r);a=w(k,"TR",{});var N=y(a);for(let g=0;g<C.length;g+=1)C[g].l(N);i=X(N),l=w(N,"TH",{class:!0,"data-svelte-h":!0}),ee(l)!=="svelte-7w0791"&&(l.innerHTML=m),N.forEach(b),k.forEach(b),u=X(s),_=w(s,"TBODY",{class:!0});var d=y(_);for(let g=0;g<A.length;g+=1)A[g].l(d);v=X(d),p=w(d,"TR",{class:!0});var H=y(p);for(let g=0;g<f.length;g+=1)f[g].l(H);I=X(H),E=w(H,"TD",{class:!0});var j=y(E);c=w(j,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(c)!=="svelte-1i38v6v"&&(c.textContent=L),j.forEach(b),H.forEach(b),d.forEach(b),s.forEach(b),R.forEach(b),this.h()},h(){M(l,"class","px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap"),M(r,"class","text-xs font-semibold uppercase text-slate-500 bg-slate-50 border-t border-b border-slate-200"),M(c,"class","btn-sm border-slate-200 hover:border-slate-300 shadow-sm text-green-500"),M(E,"class","px-5 first:pl-5 last:pr-5 py-3 whitespace-nowrap"),M(p,"class","h-full"),M(_,"class","text-sm divide-y divide-slate-200"),M(n,"class","table-auto w-full"),M(t,"class","basis-1/8 bg-white shadow-lg rounded-sm border border-slate-200")},m(o,R){F(o,t,R),h(t,n),h(n,r),h(r,a);for(let s=0;s<C.length;s+=1)C[s]&&C[s].m(a,null);h(a,i),h(a,l),h(n,u),h(n,_);for(let s=0;s<A.length;s+=1)A[s]&&A[s].m(_,null);h(_,v),h(_,p);for(let s=0;s<f.length;s+=1)f[s]&&f[s].m(p,null);h(p,I),h(p,E),h(E,c),S||(z=$(c,"click",e[4]),S=!0)},p(o,[R]){if(R&8){B=Y(o[3]);let s;for(s=0;s<B.length;s+=1){const k=he(o,B,s);C[s]?C[s].p(k,R):(C[s]=pe(k),C[s].c(),C[s].m(a,i))}for(;s<C.length;s+=1)C[s].d(1);C.length=B.length}if(R&35){O=Y(o[0]);let s;for(s=0;s<O.length;s+=1){const k=fe(o,O,s);A[s]?A[s].p(k,R):(A[s]=de(k),A[s].c(),A[s].m(_,v))}for(;s<A.length;s+=1)A[s].d(1);A.length=O.length}if(R&4){D=Y(o[2]);let s;for(s=0;s<D.length;s+=1){const k=ce(o,D,s);f[s]?f[s].p(k,R):(f[s]=me(k),f[s].c(),f[s].m(p,I))}for(;s<f.length;s+=1)f[s].d(1);f.length=D.length}},i:Z,o:Z,d(o){o&&b(t),W(C,o),W(A,o),W(f,o),S=!1,z()}}}function De(e,t,n){let{connections:r}=t,{onChangeConnections:a}=t,i=["Departure","Arrival","Transfers"],l=[...i];function m(){if(V.formatTime(l[0])===-1){alert("invalid departure time format, required HH:MM");return}if(V.formatTime(l[1])===-1){alert("invalid arrival time format, required HH:MM");return}if(!/^\d+$/.test(l[2])){alert("transfers need to be a number");return}n(0,r=[...r,new V(l[0],l[1],l[2])]),a()}function u(c){console.log("remove",c),r.splice(c,1),n(0,r),a()}function _(c,L){c[L].departure=this.innerHTML,n(0,r)}function v(c,L){c[L].arrival=this.innerHTML,n(0,r)}function p(c,L){c[L].transfers=Te(this.value),n(0,r)}const I=c=>u(c);function E(c,L){c[L]=this.innerHTML,n(2,l)}return e.$$set=c=>{"connections"in c&&n(0,r=c.connections),"onChangeConnections"in c&&n(1,a=c.onChangeConnections)},[r,a,l,i,m,u,_,v,p,I,E]}class ve extends _e{constructor(t){super(),be(this,t,De,Le,ge,{connections:0,onChangeConnections:1})}}function He(e){let t,n,r,a,i,l,m,u,_,v=e[2](e[1])+"",p,I,E,c=e[2](e[0])+"",L,S,z,B=te(e[1],e[0],[1,30]).maxImprovement+"",C,O,A,D=K(e[1],e[0],[1,30])+"",f,o,R,s=K(e[0],e[1],[1,30])+"",k,N;return a=new ve({props:{onChangeConnections:e[3],connections:e[1]}}),l=new ve({props:{onChangeConnections:e[3],connections:e[0]}}),{c(){t=T("meta"),n=P(),r=T("div"),se(a.$$.fragment),i=P(),se(l.$$.fragment),m=P(),u=T("div"),_=U("sum1: "),p=U(v),I=T("br"),E=U(`
    sum2: `),L=U(c),S=T("br"),z=U(`
    max improvement: `),C=U(B),O=T("br"),A=U(`
    set improvement LR: `),f=U(D),o=T("br"),R=U(`
    set improvement RL: `),k=U(s),this.h()},l(d){const H=Me("svelte-5ssqet",document.head);t=w(H,"META",{name:!0,content:!0}),H.forEach(b),n=X(d),r=w(d,"DIV",{class:!0});var j=y(r);le(a.$$.fragment,j),i=X(j),le(l.$$.fragment,j),j.forEach(b),m=X(d),u=w(d,"DIV",{class:!0,style:!0});var g=y(u);_=q(g,"sum1: "),p=q(g,v),I=w(g,"BR",{}),E=q(g,`
    sum2: `),L=q(g,c),S=w(g,"BR",{}),z=q(g,`
    max improvement: `),C=q(g,B),O=w(g,"BR",{}),A=q(g,`
    set improvement LR: `),f=q(g,D),o=w(g,"BR",{}),R=q(g,`
    set improvement RL: `),k=q(g,s),g.forEach(b),this.h()},h(){document.title="Home",M(t,"name","description"),M(t,"content","Svelte demo app"),M(r,"class","flex justify-center gap-8 py-8 w-full"),M(u,"class","text-center"),Ee(u,"font-family","monospace")},m(d,H){h(document.head,t),F(d,n,H),F(d,r,H),ae(a,r,null),h(r,i),ae(l,r,null),F(d,m,H),F(d,u,H),h(u,_),h(u,p),h(u,I),h(u,E),h(u,L),h(u,S),h(u,z),h(u,C),h(u,O),h(u,A),h(u,f),h(u,o),h(u,R),h(u,k),N=!0},p(d,[H]){const j={};H&2&&(j.connections=d[1]),a.$set(j);const g={};H&1&&(g.connections=d[0]),l.$set(g),(!N||H&2)&&v!==(v=d[2](d[1])+"")&&G(p,v),(!N||H&1)&&c!==(c=d[2](d[0])+"")&&G(L,c),(!N||H&3)&&B!==(B=te(d[1],d[0],[1,30]).maxImprovement+"")&&G(C,B),(!N||H&3)&&D!==(D=K(d[1],d[0],[1,30])+"")&&G(f,D),(!N||H&3)&&s!==(s=K(d[0],d[1],[1,30])+"")&&G(k,s)},i(d){N||(oe(a.$$.fragment,d),oe(l.$$.fragment,d),N=!0)},o(d){ie(a.$$.fragment,d),ie(l.$$.fragment,d),N=!1},d(d){d&&(b(n),b(r),b(m),b(u)),b(t),ue(a),ue(l)}}}function we(e,t){return t[0]*e[0]+t[1]*e[1]}function ke(e,t){let n=null,r=Number.MAX_VALUE;return t.forEach(a=>{const i=we(e,a.getCriteria2());i<r&&(r=i,n=a)}),n}function Ie(e,t,n,r){const i=e.getDeparture(),l=t.getDeparture(),m=e.getArrival(),u=t.getArrival();console.log("param: ",{ca:n},{cb:r},{depA:i},{depB:l},{arrA:m},{arrB:u});const _=e.overtakes(t)?0:Number.MAX_VALUE,v=Math.min(Math.abs(i-l),Math.abs(m-u),_);return console.log({omega:_},{distance:v}),.5*(n/r)*v}function te(e,t,n){let r=-1,a=null,i=null;return e.forEach(l=>{t.forEach(m=>{const u=l.getCriteria2(),_=m.getCriteria2();let v=0;for(let p=0;p!=n.length;++p){const I=u[p]*n[p],E=_[p]*n[p],c=Ie(l,m,I,E),L=I+c-E;L<0&&(v+=Math.pow(L,2)),console.log({i:p},{weightedA:I},{weightedB:E},{correction:c},{criterionDist:L})}v=Math.sqrt(v),v>=r&&(r=v,a=l,i=m)})}),console.assert(a!=null,"maxA == null"),console.assert(i!=null,"maxA == null"),{maxImprovement:r,maxA:a,maxB:i}}function K(e,t,n){if(e.length==0&&t.length==0)return 0;if(e.length==0)return Number.MIN_VALUE;if(t.length==0)return Number.MAX_VALUE;let r=0,a=[...e],i=[...t];console.log({aCopy:a,bCopy:i});let l=0;for(;a.length!==0;){let{maxImprovement:m,maxA:u,maxB:_}=te(a,i,n);if(console.log({maxImprovement:m,maxA:u,maxB:_}),i.push(u),a.splice(a.indexOf(u),1),console.log({aCopy:a,bCopy:i}),r+=m,m<=.1||++l>10)break}return r}function Re(e,t,n){let r,a;const i=[[1,30],[1,1],[0,1]];function l(u){let _=0;for(let v in i){const p=ke(i[v],u);_+=we(i[v],p.getCriteria2())}return _}function m(){n(1,r),n(0,a)}return n(1,r=[new V("10:00","12:00",3),new V("11:00","13:00",3)]),n(0,a=[new V("10:00","12:00",3),new V("11:00","13:00",3),new V("12:00","14:00",3)]),[a,r,l,m]}class Ne extends _e{constructor(t){super(),be(this,t,Re,He,ge,{})}}export{Ne as component,Ve as universal};
